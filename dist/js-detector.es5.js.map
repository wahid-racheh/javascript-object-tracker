{"version":3,"file":"js-detector.es5.js","sources":["../libs/canvas-resize/canvas-resize.js","../libs/src/FileSaver.js","../polyfills/requestanimationframe.js","../polyfills/usermedia.js","../src/constants.ts","../src/cv.ts","../src/utils.ts","../src/detector.ts"],"sourcesContent":["/*\n * MIT License\n *  You may use this code as long as you retain this notice.  Use at your own risk! :)\n *  https://github.com/danschumann/limby-resize\n *  0.0.8\n */\n(function() {\n  return (function(_module, namespace) {\n    _module[namespace] = function(original, canvas, callback) {\n      var w1 = original.width,\n        h1 = original.height,\n        w2 = canvas.width,\n        h2 = canvas.height,\n        img = original.getContext('2d').getImageData(0, 0, w1, h1),\n        img2 = canvas.getContext('2d').getImageData(0, 0, w2, h2);\n\n      if (w2 > w1 || h2 > h1) {\n        canvas.getContext('2d').drawImage(original, 0, 0, w2, h2);\n        return callback();\n      }\n\n      var data = img.data;\n      // it's an _ because we don't use it much, as working with doubles isn't great\n      var _data2 = img2.data;\n      // Instead, we enforce float type for every entity in the array\n      // this prevents weird faded lines when things get rounded off\n      var data2 = Array(_data2.length);\n      for (var i = 0; i < _data2.length; i++) {\n        data2[i] = 0.0;\n      }\n\n      // We track alphas, since we need to use alphas to correct colors later on\n      var alphas = Array(_data2.length >> 2);\n      for (var i = 0; i < _data2.length >> 2; i++) {\n        alphas[i] = 1;\n      }\n\n      // this will always be between 0 and 1\n      var xScale = w2 / w1;\n      var yScale = h2 / h1;\n\n      var deferred;\n\n      // We process 1 row at a time ( and then let the process rest for 0ms [async] )\n      var nextY = function(y1) {\n        for (var x1 = 0; x1 < w1; x1++) {\n          var // the original pixel is split between two pixels in the output, we do an extra step\n            extraX = false,\n            extraY = false,\n            // the output pixel\n            targetX = Math.floor(x1 * xScale),\n            targetY = Math.floor(y1 * yScale),\n            // The percentage of this pixel going to the output pixel (this gets modified)\n            xFactor = xScale,\n            yFactor = yScale,\n            // The percentage of this pixel going to the right neighbor or bottom neighbor\n            bottomFactor = 0,\n            rightFactor = 0,\n            // positions of pixels in the array\n            offset = (y1 * w1 + x1) * 4,\n            alphaOffset = 0,\n            targetOffset = (targetY * w2 + targetX) * 4;\n\n          // Right side goes into another pixel\n          if (targetX < Math.floor((x1 + 1) * xScale)) {\n            rightFactor = ((x1 + 1) * xScale) % 1;\n            xFactor -= rightFactor;\n\n            extraX = true;\n          }\n\n          // Bottom side goes into another pixel\n          if (targetY < Math.floor((y1 + 1) * yScale)) {\n            bottomFactor = ((y1 + 1) * yScale) % 1;\n            yFactor -= bottomFactor;\n\n            extraY = true;\n          }\n\n          var a;\n\n          a = data[offset + 3] / 255;\n\n          alphaOffset = targetOffset / 4;\n\n          if (extraX) {\n            // Since we're not adding the color of invisible pixels,  we multiply by a\n            data2[targetOffset + 4] += data[offset] * rightFactor * yFactor * a;\n            data2[targetOffset + 5] += data[offset + 1] * rightFactor * yFactor * a;\n            data2[targetOffset + 6] += data[offset + 2] * rightFactor * yFactor * a;\n\n            data2[targetOffset + 7] += data[offset + 3] * rightFactor * yFactor;\n\n            // if we left out the color of invisible pixels(fully or partly)\n            // the entire average we end up with will no longer be out of 255\n            // so we subtract the percentage from the alpha ( originally 1 )\n            // so that we can reverse this effect by dividing by the amount.\n            // ( if one pixel is black and invisible, and the other is white and visible,\n            // the white pixel will weight itself at 50% because it does not know the other pixel is invisible\n            // so the total(color) for the new pixel would be 128(gray), but it should be all white.\n            // the alpha will be the correct 128, combinging alphas, but we need to preserve the color\n            // of the visible pixels )\n            alphas[alphaOffset + 1] -= (1 - a) * rightFactor * yFactor;\n          }\n\n          if (extraY) {\n            data2[targetOffset + w2 * 4] += data[offset] * xFactor * bottomFactor * a;\n            data2[targetOffset + w2 * 4 + 1] += data[offset + 1] * xFactor * bottomFactor * a;\n            data2[targetOffset + w2 * 4 + 2] += data[offset + 2] * xFactor * bottomFactor * a;\n\n            data2[targetOffset + w2 * 4 + 3] += data[offset + 3] * xFactor * bottomFactor;\n\n            alphas[alphaOffset + w2] -= (1 - a) * xFactor * bottomFactor;\n          }\n\n          if (extraX && extraY) {\n            data2[targetOffset + w2 * 4 + 4] += data[offset] * rightFactor * bottomFactor * a;\n            data2[targetOffset + w2 * 4 + 5] += data[offset + 1] * rightFactor * bottomFactor * a;\n            data2[targetOffset + w2 * 4 + 6] += data[offset + 2] * rightFactor * bottomFactor * a;\n\n            data2[targetOffset + w2 * 4 + 7] += data[offset + 3] * rightFactor * bottomFactor;\n\n            alphas[alphaOffset + w2 + 1] -= (1 - a) * rightFactor * bottomFactor;\n          }\n\n          data2[targetOffset] += data[offset] * xFactor * yFactor * a;\n          data2[targetOffset + 1] += data[offset + 1] * xFactor * yFactor * a;\n          data2[targetOffset + 2] += data[offset + 2] * xFactor * yFactor * a;\n\n          data2[targetOffset + 3] += data[offset + 3] * xFactor * yFactor;\n\n          alphas[alphaOffset] -= (1 - a) * xFactor * yFactor;\n        }\n\n        if (y1++ < h1) {\n          // Big images shouldn't block for a long time.\n          // This breaks up the process and allows other processes to tick\n          setTimeout(function() {\n            nextY(y1);\n          }, 0);\n        } else done();\n      };\n\n      var done = function() {\n        // fully distribute the color of pixels that are partially full because their neighbor is transparent\n        // (i.e. undo the invisible pixels are averaged with visible ones)\n        for (var i = 0; i < _data2.length >> 2; i++) {\n          if (alphas[i] && alphas[i] < 1) {\n            data2[i << 2] /= alphas[i]; // r\n            data2[(i << 2) + 1] /= alphas[i]; // g\n            data2[(i << 2) + 2] /= alphas[i]; // b\n          }\n        }\n\n        // re populate the actual imgData\n        for (var i = 0; i < data2.length; i++) {\n          _data2[i] = Math.round(data2[i]);\n        }\n\n        var context = canvas.getContext('2d');\n        context.putImageData(img2, 0, 0);\n        callback();\n      };\n\n      // Start processing the image at row 0\n      nextY(0);\n    };\n  })(window, 'canvasResize');\n})();\n","/*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n*\n* By Eli Grey, http://eligrey.com\n*\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\n* source  : http://purl.eligrey.com/github/FileSaver.js\n*/\n\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nvar _global = typeof window === 'object' && window.window === window\n  ? window : typeof self === 'object' && self.self === self\n  ? self : typeof global === 'object' && global.global === global\n  ? global\n  : this\n\nfunction bom (blob, opts) {\n  if (typeof opts === 'undefined') opts = { autoBom: false }\n  else if (typeof opts !== 'object') {\n    console.warn('Deprecated: Expected third argument to be a object')\n    opts = { autoBom: !opts }\n  }\n\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\n  }\n  return blob\n}\n\nfunction download (url, name, opts) {\n  var xhr = new XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.onload = function () {\n    saveAs(xhr.response, name, opts)\n  }\n  xhr.onerror = function () {\n    console.error('could not download file')\n  }\n  xhr.send()\n}\n\nfunction corsEnabled (url) {\n  var xhr = new XMLHttpRequest()\n  // use sync to avoid popup blocker\n  xhr.open('HEAD', url, false)\n  try {\n    xhr.send()\n  } catch (e) {}\n  return xhr.status >= 200 && xhr.status <= 299\n}\n\n// `a.click()` doesn't work for all browsers (#465)\nfunction click (node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'))\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents')\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\n                          20, false, false, false, false, 0, null)\n    node.dispatchEvent(evt)\n  }\n}\n\nvar saveAs = _global.saveAs || (\n  // probably in some web worker\n  (typeof window !== 'object' || window !== _global)\n    ? function saveAs () { /* noop */ }\n\n  // Use download attribute first if possible (#193 Lumia mobile)\n  : 'download' in HTMLAnchorElement.prototype\n  ? function saveAs (blob, name, opts) {\n    var URL = _global.URL || _global.webkitURL\n    var a = document.createElement('a')\n    name = name || blob.name || 'download'\n\n    a.download = name\n    a.rel = 'noopener' // tabnabbing\n\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n\n    if (typeof blob === 'string') {\n      // Support regular links\n      a.href = blob\n      if (a.origin !== location.origin) {\n        corsEnabled(a.href)\n          ? download(blob, name, opts)\n          : click(a, a.target = '_blank')\n      } else {\n        click(a)\n      }\n    } else {\n      // Support blobs\n      a.href = URL.createObjectURL(blob)\n      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\n      setTimeout(function () { click(a) }, 0)\n    }\n  }\n\n  // Use msSaveOrOpenBlob as a second approach\n  : 'msSaveOrOpenBlob' in navigator\n  ? function saveAs (blob, name, opts) {\n    name = name || blob.name || 'download'\n\n    if (typeof blob === 'string') {\n      if (corsEnabled(blob)) {\n        download(blob, name, opts)\n      } else {\n        var a = document.createElement('a')\n        a.href = blob\n        a.target = '_blank'\n        setTimeout(function () { click(a) })\n      }\n    } else {\n      navigator.msSaveOrOpenBlob(bom(blob, opts), name)\n    }\n  }\n\n  // Fallback to using FileReader and a popup\n  : function saveAs (blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank')\n    if (popup) {\n      popup.document.title =\n      popup.document.body.innerText = 'downloading...'\n    }\n\n    if (typeof blob === 'string') return download(blob, name, opts)\n\n    var force = blob.type === 'application/octet-stream'\n    var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\n    var isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\n\n    if ((isChromeIOS || (force && isSafari)) && typeof FileReader === 'object') {\n      // Safari doesn't allow downloading of blob URLs\n      var reader = new FileReader()\n      reader.onloadend = function () {\n        var url = reader.result\n        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\n        if (popup) popup.location.href = url\n        else location = url\n        popup = null // reverse-tabnabbing #460\n      }\n      reader.readAsDataURL(blob)\n    } else {\n      var URL = _global.URL || _global.webkitURL\n      var url = URL.createObjectURL(blob)\n      if (popup) popup.location = url\n      else location.href = url\n      popup = null // reverse-tabnabbing #460\n      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\n    }\n  }\n)\n\n_global.saveAs = saveAs.saveAs = saveAs\n\nif (typeof module !== 'undefined') {\n  module.exports = saveAs;\n}\n","(function() {\n  return (function(_module, _requestAnimationFrame, _cancelAnimationFrame) {\n    var lastTime = new Date().getTime(),\n      startTime = lastTime,\n      vendors = ['ms', 'moz', 'webkit', 'o'];\n    _module[_requestAnimationFrame] = _module.requestAnimationFrame;\n    _module[_cancelAnimationFrame] = _module.cancelAnimationFrame;\n    for (var x = 0; x < vendors.length && !_module[_requestAnimationFrame]; ++x) {\n      _module[_requestAnimationFrame] = _module[vendors[x] + 'RequestAnimationFrame'];\n      _module[_cancelAnimationFrame] =\n        _module[vendors[x] + 'CancelAnimationFrame'] ||\n        _module[vendors[x] + 'CancelRequestAnimationFrame'];\n    }\n    if (!_module[_requestAnimationFrame]) {\n      _module[_requestAnimationFrame] = function(callback, element) {\n        var currTime = new Date().getTime();\n        var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n        var elapsed = currTime - startTime;\n        var id = _module.setTimeout(function() {\n          callback(elapsed + timeToCall);\n        }, timeToCall);\n        lastTime = currTime + timeToCall;\n        return id;\n      };\n    }\n    if (!_module[_cancelAnimationFrame]) {\n      _module[_cancelAnimationFrame] = function(id) {\n        clearTimeout(id);\n      };\n    }\n  })(window, 'requestAnimationFrame', 'cancelAnimationFrame');\n})();\n","(function() {\n  return (function(_module, _enumerateDevices, _getUserMedia) {\n    (_module[_enumerateDevices] = function() {\n      if (!_module.navigator.mediaDevices || !_module.navigator.mediaDevices.enumerateDevices) {\n        return new Promise(function(resolve, reject) {\n          reject(new Error('mediaDevices not available.'));\n        });\n      }\n      return _module.navigator.mediaDevices.enumerateDevices();\n    }),\n      (_module[_getUserMedia] = function(options) {\n        if (_module.navigator.mediaDevices === undefined) {\n          _module.navigator.mediaDevices = {};\n        }\n\n        // Some browsers partially implement mediaDevices. We can't just assign an object\n        // with getUserMedia as it would overwrite existing properties.\n        // Here, we will just add the getUserMedia property if it's missing.\n        if (_module.navigator.mediaDevices.getUserMedia === undefined) {\n          _module.navigator.mediaDevices.getUserMedia = function(constraints) {\n            // First get ahold of the legacy getUserMedia, if present\n            var getUserMedia =\n              _module.navigator.getUserMedia ||\n              _module.navigator.mozGetUserMedia ||\n              _module.navigator.webkitGetUserMedia ||\n              _module.navigator.msGetUserMedia;\n\n            // Some browsers just don't implement it - return a rejected promise with an error\n            // to keep a consistent interface\n            if (!getUserMedia) {\n              return new Promise(function(resolve, reject) {\n                reject(new Error('WebRTC not available.'));\n              });\n            }\n\n            // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n            return new Promise(function(resolve, reject) {\n              getUserMedia.call(_module.navigator, constraints, resolve, reject);\n            });\n          };\n        }\n\n        return _module.navigator.mediaDevices.getUserMedia(options);\n      });\n  })(window, 'enumerateDevices', 'getUserMedia');\n})();\n","export const stackBoxBlurMult: number[] = [\n  1,\n  171,\n  205,\n  293,\n  57,\n  373,\n  79,\n  137,\n  241,\n  27,\n  391,\n  357,\n  41,\n  19,\n  283,\n  265\n];\n\nexport const stackBoxBlurShift: number[] = [\n  0,\n  9,\n  10,\n  11,\n  9,\n  12,\n  10,\n  11,\n  12,\n  9,\n  13,\n  13,\n  10,\n  9,\n  13,\n  13\n];\n\nexport const neighborhood: any[] = [\n  [1, 0],\n  [1, -1],\n  [0, -1],\n  [-1, -1],\n  [-1, 0],\n  [-1, 1],\n  [0, 1],\n  [1, 1]\n];\n","/*\nCopyright (c) 2011 Juan Mellado\nUpdated by `Racheh Wahid` (2019)\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the 'Software'), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n\nReferences:\n- 'OpenCV: Open Computer Vision Library'\n  http://sourceforge.net/projects/opencvlibrary/\n- 'Stack Blur: Fast But Goodlooking'\n  http://incubator.quasimondo.com/processing/fast_blur_deluxe.php\n*/\n\nimport { ICoordinate, IImage, IBlurStack, IPoint, IRect } from './interfaces';\nimport { stackBoxBlurMult, stackBoxBlurShift, neighborhood } from './constants';\n\nexport const blurStack = (): IBlurStack => {\n  return {\n    color: 0,\n    next: null\n  };\n};\n\nexport const getImage = (image?: IImage): IImage => {\n  return image\n    ? {\n        width: image.width || 0,\n        height: image.height || 0,\n        data: image.data || []\n      }\n    : {\n        width: 0,\n        height: 0,\n        data: []\n      };\n};\n\nexport const grayscaleOld = (imageSrc: IImage, imageDst: IImage): IImage => {\n  let src: any[] = imageSrc.data,\n    dst: any[] = imageDst.data,\n    len: number = src.length,\n    i: number = 0,\n    j: number = 0;\n\n  for (; i < len; i += 4) {\n    dst[j++] = (src[i] * 0.299 + src[i + 1] * 0.587 + src[i + 2] * 0.114 + 0.5) & 0xff;\n  }\n\n  imageDst.width = imageSrc.width;\n  imageDst.height = imageSrc.height;\n\n  return imageDst;\n};\n\nexport const grayscale = (imageSrc: IImage, imageDst: IImage): IImage => {\n  let src: any[] = imageSrc.data,\n    dst: any[] = imageDst.data;\n  let len: number = src.length | 0,\n    srcLength_16: number = (len - 16) | 0;\n\n  let i: number = 0,\n    j: number = 0;\n  let coeff_r: number = 0.6,\n    coeff_g: number = 0.9,\n    coeff_b: number = 0.2;\n  //let coeff_r: number = 0.299, coeff_g: number = 0.587, coeff_b: number = 0.114;\n  //let coeff_r: number = 4899, coeff_g: number = 9617, coeff_b: number = 1868;\n\n  for (i = 0; i <= srcLength_16; i += 16, j += 4) {\n    dst[j] = (src[i] * coeff_r + src[i + 1] * coeff_g + src[i + 2] * coeff_b + 8192) & 0xff;\n    dst[j + 1] = (src[i + 4] * coeff_r + src[i + 5] * coeff_g + src[i + 6] * coeff_b + 8192) & 0xff;\n    dst[j + 2] =\n      (src[i + 8] * coeff_r + src[i + 9] * coeff_g + src[i + 10] * coeff_b + 8192) & 0xff;\n    dst[j + 3] =\n      (src[i + 12] * coeff_r + src[i + 13] * coeff_g + src[i + 14] * coeff_b + 8192) & 0xff;\n  }\n\n  for (i = 0; i < len; i += 4) {\n    dst[j++] = (src[i] * coeff_r + src[i + 1] * coeff_g + src[i + 2] * coeff_b + 0.5) & 0xff;\n  }\n\n  imageDst.width = imageSrc.width;\n  imageDst.height = imageSrc.height;\n\n  return imageDst;\n};\n\nexport const threshold = (imageSrc: IImage, imageDst: IImage, threshold: number): IImage => {\n  let src: any[] = imageSrc.data,\n    dst: any[] = imageDst.data,\n    len: number = src.length,\n    tab: any[] = [],\n    i: number;\n\n  for (i = 0; i < 256; ++i) {\n    tab[i] = i <= threshold ? 0 : 255;\n  }\n\n  for (i = 0; i < len; ++i) {\n    dst[i] = tab[src[i]];\n  }\n\n  imageDst.width = imageSrc.width;\n  imageDst.height = imageSrc.height;\n\n  return imageDst;\n};\n\nexport const stackBoxBlur = (imageSrc: IImage, imageDst: IImage, kernelSize: number): IImage => {\n  let src: any[] = imageSrc.data,\n    dst: any[] = imageDst.data,\n    height: number = imageSrc.height,\n    width: number = imageSrc.width,\n    heightMinus1: number = height - 1,\n    widthMinus1: number = width - 1,\n    size: number = kernelSize + kernelSize + 1,\n    radius: number = kernelSize + 1,\n    mult: number = stackBoxBlurMult[kernelSize],\n    shift: number = stackBoxBlurShift[kernelSize],\n    stack: IBlurStack,\n    stackStart: IBlurStack,\n    color: number,\n    sum: number,\n    pos: number,\n    start: number,\n    p: number,\n    x: number,\n    y: number,\n    i: number;\n\n  stack = stackStart = blurStack();\n  for (i = 1; i < size; ++i) {\n    stack = stack.next = blurStack();\n  }\n  stack.next = stackStart;\n\n  pos = 0;\n\n  for (y = 0; y < height; ++y) {\n    start = pos;\n\n    color = src[pos];\n    sum = radius * color;\n\n    stack = stackStart;\n    for (i = 0; i < radius; ++i) {\n      stack.color = color;\n      stack = stack.next;\n    }\n    for (i = 1; i < radius; ++i) {\n      stack.color = src[pos + i];\n      sum += stack.color;\n      stack = stack.next;\n    }\n\n    stack = stackStart;\n    for (x = 0; x < width; ++x) {\n      dst[pos++] = (sum * mult) >>> shift;\n\n      p = x + radius;\n      p = start + (p < widthMinus1 ? p : widthMinus1);\n      sum -= stack.color - src[p];\n\n      stack.color = src[p];\n      stack = stack.next;\n    }\n  }\n\n  for (x = 0; x < width; ++x) {\n    pos = x;\n    start = pos + width;\n\n    color = dst[pos];\n    sum = radius * color;\n\n    stack = stackStart;\n    for (i = 0; i < radius; ++i) {\n      stack.color = color;\n      stack = stack.next;\n    }\n    for (i = 1; i < radius; ++i) {\n      stack.color = dst[start];\n      sum += stack.color;\n      stack = stack.next;\n\n      start += width;\n    }\n\n    stack = stackStart;\n    for (y = 0; y < height; ++y) {\n      dst[pos] = (sum * mult) >>> shift;\n\n      p = y + radius;\n      p = x + (p < heightMinus1 ? p : heightMinus1) * width;\n      sum -= stack.color - dst[p];\n\n      stack.color = dst[p];\n      stack = stack.next;\n\n      pos += width;\n    }\n  }\n\n  return imageDst;\n};\n\nexport const adaptiveThreshold = (\n  imageSrc: IImage,\n  imageDst: IImage,\n  kernelSize: number,\n  threshold: number\n): IImage => {\n  let src: any[] = imageSrc.data,\n    dst: any[] = imageDst.data,\n    len: number = src.length,\n    tab: any[] = [],\n    i: number;\n\n  stackBoxBlur(imageSrc, imageDst, kernelSize);\n\n  for (i = 0; i < 768; ++i) {\n    tab[i] = i - 255 <= -threshold ? 255 : 0;\n  }\n\n  for (i = 0; i < len; ++i) {\n    dst[i] = tab[src[i] - dst[i] + 255];\n  }\n\n  imageDst.width = imageSrc.width;\n  imageDst.height = imageSrc.height;\n\n  return imageDst;\n};\n\nexport const otsu = (imageSrc: IImage): number => {\n  let src: any[] = imageSrc.data,\n    len: number = src.length,\n    hist: any[] = [],\n    threshold: number = 0,\n    sum: number = 0,\n    sumB: number = 0,\n    wB: number = 0,\n    wF: number = 0,\n    max: number = 0,\n    mu: number,\n    between: number,\n    i: number;\n\n  for (i = 0; i < 256; ++i) {\n    hist[i] = 0;\n  }\n\n  for (i = 0; i < len; ++i) {\n    hist[src[i]]++;\n  }\n\n  for (i = 0; i < 256; ++i) {\n    sum += hist[i] * i;\n  }\n\n  for (i = 0; i < 256; ++i) {\n    wB += hist[i];\n    if (0 !== wB) {\n      wF = len - wB;\n      if (0 === wF) {\n        break;\n      }\n\n      sumB += hist[i] * i;\n\n      mu = sumB / wB - (sum - sumB) / wF;\n\n      between = wB * wF * mu * mu;\n\n      if (between > max) {\n        max = between;\n        threshold = i;\n      }\n    }\n  }\n\n  return threshold;\n};\n\nexport const gaussianKernel = (kernelSize: number): any[] => {\n  let tab: any[] = [\n      [1],\n      [0.25, 0.5, 0.25],\n      [0.0625, 0.25, 0.375, 0.25, 0.0625],\n      [0.03125, 0.109375, 0.21875, 0.28125, 0.21875, 0.109375, 0.03125]\n    ],\n    kernel: any[] = [],\n    center: number,\n    sigma: number,\n    scale2X: number,\n    sum: number,\n    x: number,\n    i: number;\n\n  if (kernelSize <= 7 && kernelSize % 2 === 1) {\n    kernel = tab[kernelSize >> 1];\n  } else {\n    center = (kernelSize - 1.0) * 0.5;\n    sigma = 0.8 + 0.3 * (center - 1.0);\n    scale2X = -0.5 / (sigma * sigma);\n    sum = 0.0;\n    for (i = 0; i < kernelSize; ++i) {\n      x = i - center;\n      sum += kernel[i] = Math.exp(scale2X * x * x);\n    }\n    sum = 1 / sum;\n    for (i = 0; i < kernelSize; ++i) {\n      kernel[i] *= sum;\n    }\n  }\n\n  return kernel;\n};\n\nexport const gaussianBlurFilter = (\n  imageSrc: IImage,\n  imageDst: IImage,\n  kernel: any[],\n  horizontal: boolean\n): IImage => {\n  let src: any[] = imageSrc.data,\n    dst: any[] = imageDst.data,\n    height: number = imageSrc.height,\n    width: number = imageSrc.width,\n    pos: number = 0,\n    limit: number = kernel.length >> 1,\n    cur: number,\n    value: number,\n    i: number,\n    j: number,\n    k: number;\n\n  for (i = 0; i < height; ++i) {\n    for (j = 0; j < width; ++j) {\n      value = 0.0;\n\n      for (k = -limit; k <= limit; ++k) {\n        if (horizontal) {\n          cur = pos + k;\n          if (j + k < 0) {\n            cur = pos;\n          } else if (j + k >= width) {\n            cur = pos;\n          }\n        } else {\n          cur = pos + k * width;\n          if (i + k < 0) {\n            cur = pos;\n          } else if (i + k >= height) {\n            cur = pos;\n          }\n        }\n\n        value += kernel[limit + k] * src[cur];\n      }\n\n      dst[pos++] = horizontal ? value : (value + 0.5) & 0xff;\n    }\n  }\n\n  return imageDst;\n};\n\nexport const gaussianBlur = (\n  imageSrc: IImage,\n  imageDst: IImage,\n  imageMean: IImage,\n  kernelSize: number\n): IImage => {\n  let kernel = gaussianKernel(kernelSize);\n\n  imageDst.width = imageSrc.width;\n  imageDst.height = imageSrc.height;\n\n  imageMean.width = imageSrc.width;\n  imageMean.height = imageSrc.height;\n\n  gaussianBlurFilter(imageSrc, imageMean, kernel, true);\n  gaussianBlurFilter(imageMean, imageDst, kernel, false);\n\n  return imageDst;\n};\n\nexport const binaryBorder = (imageSrc: IImage, dst: any[]): any[] => {\n  let src: any[] = imageSrc.data,\n    height: number = imageSrc.height,\n    width: number = imageSrc.width,\n    posSrc: number = 0,\n    posDst: number = 0,\n    i: number,\n    j: number;\n\n  for (j = -2; j < width; ++j) {\n    dst[posDst++] = 0;\n  }\n\n  for (i = 0; i < height; ++i) {\n    dst[posDst++] = 0;\n\n    for (j = 0; j < width; ++j) {\n      dst[posDst++] = 0 === src[posSrc++] ? 0 : 1;\n    }\n\n    dst[posDst++] = 0;\n  }\n\n  for (j = -2; j < width; ++j) {\n    dst[posDst++] = 0;\n  }\n\n  return dst;\n};\n\nexport const neighborhoodDeltas = (width: number): any[] => {\n  let deltas: any[] = [],\n    len: number = neighborhood.length,\n    i: number = 0;\n\n  for (; i < len; ++i) {\n    deltas[i] = neighborhood[i][0] + neighborhood[i][1] * width;\n  }\n\n  return deltas.concat(deltas);\n};\n\nexport const borderFollowing = (\n  src: any[],\n  pos: number,\n  nbd: number,\n  point: any,\n  hole: boolean,\n  deltas: any[]\n) => {\n  let contour: any[] = [],\n    pos1: number,\n    pos3: number,\n    pos4: number,\n    s: any,\n    s_end: any,\n    s_prev: any;\n\n  //contour.hole = hole;\n\n  s = s_end = hole ? 0 : 4;\n  do {\n    s = (s - 1) & 7;\n    pos1 = pos + deltas[s];\n    if (src[pos1] !== 0) {\n      break;\n    }\n  } while (s !== s_end);\n\n  if (s === s_end) {\n    src[pos] = -nbd;\n    contour.push({ x: point.x, y: point.y });\n  } else {\n    pos3 = pos;\n    s_prev = s ^ 4;\n\n    while (true) {\n      s_end = s;\n\n      do {\n        pos4 = pos3 + deltas[++s];\n      } while (src[pos4] === 0);\n\n      s &= 7;\n\n      if ((s - 1) >>> 0 < s_end >>> 0) {\n        src[pos3] = -nbd;\n      } else if (src[pos3] === 1) {\n        src[pos3] = nbd;\n      }\n\n      contour.push({ x: point.x, y: point.y });\n\n      s_prev = s;\n\n      point.x += neighborhood[s][0];\n      point.y += neighborhood[s][1];\n\n      if (pos4 === pos && pos3 === pos1) {\n        break;\n      }\n\n      pos3 = pos4;\n      s = (s + 4) & 7;\n    }\n  }\n\n  return contour;\n};\n\nexport const findContours = (imageSrc: IImage, binary: any[]) => {\n  let width: number = imageSrc.width,\n    height: number = imageSrc.height,\n    contours: any[] = [],\n    src: any[],\n    deltas: any[],\n    pos: number,\n    pix: any,\n    nbd: number,\n    outer: boolean,\n    hole: boolean,\n    i: number,\n    j: number;\n\n  src = binaryBorder(imageSrc, binary);\n\n  deltas = neighborhoodDeltas(width + 2);\n\n  pos = width + 3;\n  nbd = 1;\n\n  for (i = 0; i < height; ++i, pos += 2) {\n    for (j = 0; j < width; ++j, ++pos) {\n      pix = src[pos];\n\n      if (0 !== pix) {\n        outer = hole = false;\n\n        if (1 === pix && 0 === src[pos - 1]) {\n          outer = true;\n        } else if (pix >= 1 && 0 === src[pos + 1]) {\n          hole = true;\n        }\n\n        if (outer || hole) {\n          ++nbd;\n\n          contours.push(borderFollowing(src, pos, nbd, { x: j, y: i }, hole, deltas));\n        }\n      }\n    }\n  }\n\n  return contours;\n};\n\nexport const approxPolyDP = (contour: any, epsilon: number) => {\n  let slice: any = { start_index: 0, end_index: 0 },\n    right_slice: any = { start_index: 0, end_index: 0 },\n    poly: any[] = [],\n    stack: any[] = [],\n    len: number = contour.length,\n    pt: IPoint,\n    start_pt: IPoint = { x: 0, y: 0 },\n    end_pt: IPoint = { x: 0, y: 0 },\n    dist: number,\n    max_dist: number = 0,\n    le_eps: boolean,\n    dx: number,\n    dy: number,\n    i: number,\n    j: number,\n    k: number;\n\n  epsilon *= epsilon;\n\n  k = 0;\n\n  for (i = 0; i < 3; ++i) {\n    max_dist = 0;\n\n    k = (k + right_slice.start_index) % len;\n    start_pt = contour[k];\n    if (++k === len) {\n      k = 0;\n    }\n\n    for (j = 1; j < len; ++j) {\n      pt = contour[k];\n      if (++k === len) {\n        k = 0;\n      }\n\n      dx = pt.x - start_pt.x;\n      dy = pt.y - start_pt.y;\n      dist = dx * dx + dy * dy;\n\n      if (dist > max_dist) {\n        max_dist = dist;\n        right_slice.start_index = j;\n      }\n    }\n  }\n\n  if (max_dist <= epsilon) {\n    poly.push({ x: start_pt.x, y: start_pt.y });\n  } else {\n    slice.start_index = k;\n    slice.end_index = right_slice.start_index += slice.start_index;\n\n    right_slice.start_index -= right_slice.start_index >= len ? len : 0;\n    right_slice.end_index = slice.start_index;\n    if (right_slice.end_index < right_slice.start_index) {\n      right_slice.end_index += len;\n    }\n\n    stack.push({\n      start_index: right_slice.start_index,\n      end_index: right_slice.end_index\n    });\n    stack.push({\n      start_index: slice.start_index,\n      end_index: slice.end_index\n    });\n  }\n\n  while (stack.length !== 0) {\n    slice = stack.pop();\n\n    end_pt = contour[slice.end_index % len];\n    start_pt = contour[(k = slice.start_index % len)];\n    if (++k === len) {\n      k = 0;\n    }\n\n    if (slice.end_index <= slice.start_index + 1) {\n      le_eps = true;\n    } else {\n      max_dist = 0;\n\n      dx = end_pt.x - start_pt.x;\n      dy = end_pt.y - start_pt.y;\n\n      for (i = slice.start_index + 1; i < slice.end_index; ++i) {\n        pt = contour[k];\n        if (++k === len) {\n          k = 0;\n        }\n\n        dist = Math.abs((pt.y - start_pt.y) * dx - (pt.x - start_pt.x) * dy);\n\n        if (dist > max_dist) {\n          max_dist = dist;\n          right_slice.start_index = i;\n        }\n      }\n\n      le_eps = max_dist * max_dist <= epsilon * (dx * dx + dy * dy);\n    }\n\n    if (le_eps) {\n      poly.push({ x: start_pt.x, y: start_pt.y });\n    } else {\n      right_slice.end_index = slice.end_index;\n      slice.end_index = right_slice.start_index;\n\n      stack.push({\n        start_index: right_slice.start_index,\n        end_index: right_slice.end_index\n      });\n      stack.push({\n        start_index: slice.start_index,\n        end_index: slice.end_index\n      });\n    }\n  }\n\n  return poly;\n};\n\nexport const isContourConvex = (contour: any) => {\n  let orientation: number = 0,\n    convex: boolean = true,\n    len: number = contour.length,\n    i: number = 0,\n    j: number = 0,\n    cur_pt: IPoint,\n    prev_pt: IPoint,\n    dxdy0: number,\n    dydx0: number,\n    dx0: number,\n    dy0: number,\n    dx: number,\n    dy: number;\n\n  prev_pt = contour[len - 1];\n  cur_pt = contour[0];\n\n  dx0 = cur_pt.x - prev_pt.x;\n  dy0 = cur_pt.y - prev_pt.y;\n\n  for (; i < len; ++i) {\n    if (++j === len) {\n      j = 0;\n    }\n\n    prev_pt = cur_pt;\n    cur_pt = contour[j];\n\n    dx = cur_pt.x - prev_pt.x;\n    dy = cur_pt.y - prev_pt.y;\n    dxdy0 = dx * dy0;\n    dydx0 = dy * dx0;\n\n    orientation |= dydx0 > dxdy0 ? 1 : dydx0 < dxdy0 ? 2 : 3;\n\n    if (3 === orientation) {\n      convex = false;\n      break;\n    }\n\n    dx0 = dx;\n    dy0 = dy;\n  }\n\n  return convex;\n};\n\nexport const getRectSize = (\n  x: number,\n  y: number,\n  tl: IPoint,\n  tr: IPoint,\n  bl: IPoint,\n  br: IPoint\n): IRect => {\n  // Calculate the max width/height\n  let wb: number = Math.hypot(br.x - bl.x, br.y - bl.y);\n  let wt: number = Math.hypot(tr.x - tl.x, tr.y - tl.y);\n  let w: number = wb > wt ? wb : wt;\n  let hr: number = Math.hypot(tr.x - br.x, tr.y - br.y);\n  let hl: number = Math.hypot(tl.x - bl.x, tr.y - bl.y);\n  let h: number = hr > hl ? hr : hl;\n\n  return {\n    width: w,\n    height: h,\n    x: x,\n    y: y,\n    tl: tl,\n    tr: tr,\n    bl: bl,\n    br: br\n  };\n};\n\nexport const findCornersPosition = (contour: any): IRect => {\n  const cornerArray = [contour[3], contour[0], contour[2], contour[1]];\n  //Determine left/right based on x position of top and bottom 2\n  const tl = cornerArray[0].x < cornerArray[1].x ? cornerArray[0] : cornerArray[1];\n  const tr = cornerArray[0].x > cornerArray[1].x ? cornerArray[0] : cornerArray[1];\n  const bl = cornerArray[2].x < cornerArray[3].x ? cornerArray[2] : cornerArray[3];\n  const br = cornerArray[2].x > cornerArray[3].x ? cornerArray[2] : cornerArray[3];\n\n  return getRectSize(cornerArray[0].x, cornerArray[0].y, tl, tr, bl, br);\n};\n\nexport const minEdgeLength = (poly: any): number => {\n  let len: number = poly.length,\n    i: number = 0,\n    j: number = len - 1,\n    min: any = Infinity,\n    d: number,\n    dx: number,\n    dy: number;\n\n  for (; i < len; j = i++) {\n    dx = poly[i].x - poly[j].x;\n    dy = poly[i].y - poly[j].y;\n\n    d = dx * dx + dy * dy;\n\n    if (d < min) {\n      min = d;\n    }\n  }\n\n  return Math.sqrt(min);\n};\n\nexport const findCandidates = (\n  contours: any[],\n  minSize: number,\n  epsilon: number,\n  minLength: number,\n  minLimit: number\n) => {\n  let candidates: any[] = [],\n    len: number = contours.length,\n    contour: any,\n    poly: any,\n    i: number;\n\n  for (i = 0; i < len; ++i) {\n    contour = contours[i];\n\n    if (contour.length >= minSize) {\n      poly = approxPolyDP(contour, contour.length * epsilon);\n\n      if (poly.length === 4 && isContourConvex(poly)) {\n        poly.point = findCornersPosition(poly);\n\n        const min = minEdgeLength(poly);\n\n        poly.hasValidEdgeLength = min >= minLimit;\n\n        if (min >= minLength) {\n          candidates.push(poly);\n        }\n      }\n    }\n  }\n\n  return candidates;\n};\n\nexport const detectContour = (image: IImage, ceil: number) => {\n  let grey: IImage = getImage();\n  let thres: IImage = getImage();\n  let binary: any[] = [];\n\n  grayscale(image, grey);\n  adaptiveThreshold(grey, thres, 2, 1);\n\n  let contours: any = findContours(thres, binary);\n\n  let size: number = image.width < image.height ? image.width : image.height;\n  let candidates: any = findCandidates(\n    contours,\n    image.width * 0.2,\n    0.05,\n    100,\n    size - (ceil * 2 + 20)\n  );\n\n  return candidates;\n};\n\nexport const square2quad = (src: IPoint[]) => {\n  let sq: any[] = [],\n    px: number,\n    py: number,\n    dx1: number,\n    dx2: number,\n    dy1: number,\n    dy2: number,\n    den: number;\n\n  px = src[0].x - src[1].x + src[2].x - src[3].x;\n  py = src[0].y - src[1].y + src[2].y - src[3].y;\n\n  if (0 === px && 0 === py) {\n    sq[0] = src[1].x - src[0].x;\n    sq[1] = src[2].x - src[1].x;\n    sq[2] = src[0].x;\n    sq[3] = src[1].y - src[0].y;\n    sq[4] = src[2].y - src[1].y;\n    sq[5] = src[0].y;\n    sq[6] = 0;\n    sq[7] = 0;\n    sq[8] = 1;\n  } else {\n    dx1 = src[1].x - src[2].x;\n    dx2 = src[3].x - src[2].x;\n    dy1 = src[1].y - src[2].y;\n    dy2 = src[3].y - src[2].y;\n    den = dx1 * dy2 - dx2 * dy1;\n\n    sq[6] = (px * dy2 - dx2 * py) / den;\n    sq[7] = (dx1 * py - px * dy1) / den;\n    sq[8] = 1;\n    sq[0] = src[1].x - src[0].x + sq[6] * src[1].x;\n    sq[1] = src[3].x - src[0].x + sq[7] * src[3].x;\n    sq[2] = src[0].x;\n    sq[3] = src[1].y - src[0].y + sq[6] * src[1].y;\n    sq[4] = src[3].y - src[0].y + sq[7] * src[3].y;\n    sq[5] = src[0].y;\n  }\n\n  return sq;\n};\n\nexport const getPerspectiveTransform = (src: IPoint[], size: number) => {\n  let rq: any = square2quad(src);\n\n  rq[0] /= size;\n  rq[1] /= size;\n  rq[3] /= size;\n  rq[4] /= size;\n  rq[6] /= size;\n  rq[7] /= size;\n\n  return rq;\n};\n\nexport const warp = (\n  imageSrc: IImage,\n  imageDst: IImage,\n  contour: any,\n  warpSize: number\n): IImage => {\n  let src: any[] = imageSrc.data,\n    dst: any[] = imageDst.data,\n    width: number = imageSrc.width,\n    height: number = imageSrc.height,\n    pos: number = 0,\n    sx1: number,\n    sx2: number,\n    dx1: number,\n    dx2: number,\n    sy1: number,\n    sy2: number,\n    dy1: number,\n    dy2: number,\n    p1: number,\n    p2: number,\n    p3: number,\n    p4: number,\n    m: any,\n    r: number,\n    s: number,\n    t: number,\n    u: number,\n    v: number,\n    w: number,\n    x: number,\n    y: number,\n    i: number,\n    j: number;\n\n  m = getPerspectiveTransform(contour, warpSize - 1);\n\n  r = m[8];\n  s = m[2];\n  t = m[5];\n\n  for (i = 0; i < warpSize; ++i) {\n    r += m[7];\n    s += m[1];\n    t += m[4];\n\n    u = r;\n    v = s;\n    w = t;\n\n    for (j = 0; j < warpSize; ++j) {\n      u += m[6];\n      v += m[0];\n      w += m[3];\n\n      x = v / u;\n      y = w / u;\n\n      sx1 = x >>> 0;\n      sx2 = sx1 === width - 1 ? sx1 : sx1 + 1;\n      dx1 = x - sx1;\n      dx2 = 1.0 - dx1;\n\n      sy1 = y >>> 0;\n      sy2 = sy1 === height - 1 ? sy1 : sy1 + 1;\n      dy1 = y - sy1;\n      dy2 = 1.0 - dy1;\n\n      p1 = p2 = sy1 * width;\n      p3 = p4 = sy2 * width;\n\n      dst[pos++] =\n        (dy2 * (dx2 * src[p1 + sx1] + dx1 * src[p2 + sx2]) +\n          dy1 * (dx2 * src[p3 + sx1] + dx1 * src[p4 + sx2])) &\n        0xff;\n    }\n  }\n\n  imageDst.width = warpSize;\n  imageDst.height = warpSize;\n\n  return imageDst;\n};\n\nexport const perimeter = (poly: any): number => {\n  let len: number = poly.length,\n    i: number = 0,\n    j: number = len - 1,\n    p: number = 0.0,\n    dx: number,\n    dy: number;\n\n  for (; i < len; j = i++) {\n    dx = poly[i].x - poly[j].x;\n    dy = poly[i].y - poly[j].y;\n\n    p += Math.sqrt(dx * dx + dy * dy);\n  }\n\n  return p;\n};\n\nexport const countNonZero = (imageSrc: IImage, square: IPoint): number => {\n  let src: any = imageSrc.data,\n    height: number = square.height || 0,\n    width: number = square.width || 0,\n    pos: number = square.x + square.y * imageSrc.width,\n    span: number = imageSrc.width - width,\n    nz: number = 0,\n    i: number,\n    j: number;\n\n  for (i = 0; i < height; ++i) {\n    for (j = 0; j < width; ++j) {\n      if (0 !== src[pos++]) {\n        ++nz;\n      }\n    }\n\n    pos += span;\n  }\n\n  return nz;\n};\n\nexport const isValidPoint = (p1: IRect, p2: IRect, ceil: number): boolean => {\n  const isValidTlx = p1.tl.x >= p2.tl.x - ceil;\n  const isValidTly = p1.tl.y >= p2.tl.y - ceil;\n\n  const isValidTrx = p1.tr.x <= p2.tr.x + ceil;\n  const isValidTry = p1.tr.y >= p2.tr.y - ceil;\n\n  const isValidBlx = p1.bl.x >= p2.bl.x - ceil;\n  const isValidBly = p1.bl.y <= p2.bl.y + ceil;\n\n  const isValidBrx = p1.br.x <= p2.br.x + ceil;\n  const isValidBry = p1.br.y <= p2.br.y + ceil;\n\n  const isValidTx = p1.tl.x <= p2.tl.x + ceil;\n  const isValidBx = p1.br.x >= p2.br.x - ceil;\n\n  const isValidTy = p1.tl.y <= p2.tl.y + ceil;\n  const isValidBy = p1.br.y >= p2.br.y - ceil;\n\n  return (\n    isValidTlx &&\n    isValidTly &&\n    isValidTrx &&\n    isValidTry &&\n    isValidBlx &&\n    isValidBly &&\n    isValidBrx &&\n    isValidBry &&\n    ((isValidTx && isValidBx) || (isValidTy && isValidBy))\n  );\n};\n\nexport const diff = (num1: number, num2: number): number => {\n  if (num1 > num2) {\n    return num1 - num2;\n  } else {\n    return num2 - num1;\n  }\n};\n\nexport const distance = (x1: number, x2: number, y1: number, y2: number): number => {\n  var deltaX = diff(x1, x2);\n  var deltaY = diff(y1, y2);\n  var dist = Math.sqrt(Math.pow(deltaX, 2) + Math.pow(deltaY, 2));\n  return dist;\n};\n\nexport const getRectCoordinates = (\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  radius?: any\n): IRect => {\n  if (typeof radius === 'undefined') {\n    radius = 1;\n  }\n  if (typeof radius === 'number') {\n    radius = { tl: radius, tr: radius, br: radius, bl: radius };\n  } else {\n    let defaultRadius: any = { tl: 0, tr: 0, br: 0, bl: 0 };\n    let keys = Object.keys(defaultRadius);\n    for (let i = 0; i < keys.length; i++) {\n      let side = keys[i];\n      radius[side] = radius[side] || defaultRadius[side];\n    }\n  }\n\n  return {\n    tr: {\n      x: x + width - radius.tr,\n      y: y,\n      qct: { cpx: x + width, cpy: y, x: x + width, y: y + radius.tr }\n    },\n    br: {\n      x: x + width,\n      y: y + height - radius.br,\n      qct: {\n        cpx: x + width,\n        cpy: y + height,\n        x: x + width - radius.br,\n        y: y + height\n      }\n    },\n    bl: {\n      x: x + radius.bl,\n      y: y + height,\n      qct: { cpx: x, cpy: y + height, x: x, y: y + height - radius.bl }\n    },\n    tl: {\n      x: x,\n      y: y + radius.tl,\n      qct: { cpx: x, cpy: y, x: x + radius.tl, y: y }\n    },\n    x: x,\n    y: y,\n    radius: radius\n  };\n};\n\n// Draw rectangle : draw 4 lines\nexport const drawRect = (\n  ctx: any,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  lineWidth: number,\n  color: string,\n  radius?: any,\n  fill?: any,\n  stroke?: boolean\n) => {\n  if (typeof stroke === 'undefined') {\n    stroke = true;\n  }\n\n  let rectCoordinate: IRect = getRectCoordinates(x, y, width, height, radius);\n  // Draw lines\n  ctx.beginPath();\n  ctx.lineWidth = lineWidth;\n  ctx.strokeStyle = color;\n  ctx.moveTo(rectCoordinate.x + rectCoordinate.radius.tl, rectCoordinate.y);\n  ctx.lineTo(rectCoordinate.tr.x, rectCoordinate.tr.y);\n  if (rectCoordinate.tr.qct) {\n    ctx.quadraticCurveTo(\n      rectCoordinate.tr.qct.cpx,\n      rectCoordinate.tr.qct.cpy,\n      rectCoordinate.tr.qct.x,\n      rectCoordinate.tr.qct.y\n    );\n  }\n  ctx.lineTo(rectCoordinate.br.x, rectCoordinate.br.y);\n  if (rectCoordinate.br.qct) {\n    ctx.quadraticCurveTo(\n      rectCoordinate.br.qct.cpx,\n      rectCoordinate.br.qct.cpy,\n      rectCoordinate.br.qct.x,\n      rectCoordinate.br.qct.y\n    );\n  }\n  ctx.lineTo(rectCoordinate.bl.x, rectCoordinate.bl.y);\n  if (rectCoordinate.bl.qct) {\n    ctx.quadraticCurveTo(\n      rectCoordinate.bl.qct.cpx,\n      rectCoordinate.bl.qct.cpy,\n      rectCoordinate.bl.qct.x,\n      rectCoordinate.bl.qct.y\n    );\n  }\n  ctx.lineTo(rectCoordinate.tl.x, rectCoordinate.tl.y);\n  if (rectCoordinate.tl.qct) {\n    ctx.quadraticCurveTo(\n      rectCoordinate.tl.qct.cpx,\n      rectCoordinate.tl.qct.cpy,\n      rectCoordinate.tl.qct.x,\n      rectCoordinate.tl.qct.y\n    );\n  }\n  ctx.closePath();\n\n  if (fill) {\n    ctx.fill();\n  }\n  if (stroke) {\n    ctx.stroke();\n  }\n};\n\n// Get outside rectangles area coordinates\nexport const getOutsideRectCoordinates = (\n  ceil: number,\n  contextWidth: number,\n  rectTopLeftX: number,\n  rectTopLeftY: number,\n  rectTopRightX: number,\n  rectTopRightY: number,\n  rectBottomLeftY: number,\n  rectWidth: number,\n  rectHeight: number\n): ICoordinate => {\n  let rectRadius: ICoordinate = {\n    top: { x: 0, y: 0, width: 0, height: 0 },\n    left: { x: 0, y: 0, width: 0, height: 0 },\n    right: { x: 0, y: 0, width: 0, height: 0 },\n    bottom: { x: 0, y: 0, width: 0, height: 0 }\n  };\n\n  // Top area\n  rectRadius.top.width = contextWidth;\n  rectRadius.top.height = rectTopLeftY - 1;\n\n  // Bottom area\n  rectRadius.bottom.y = rectBottomLeftY;\n  rectRadius.bottom.width = contextWidth;\n  rectRadius.bottom.height = rectBottomLeftY - 0.1;\n\n  // Left area\n  rectRadius.left.y = rectTopLeftY - 1;\n  rectRadius.left.width = rectTopLeftX;\n  rectRadius.left.height = rectHeight;\n\n  // Right area\n  rectRadius.right.x = rectTopRightX;\n  rectRadius.right.y = rectTopRightY;\n  rectRadius.right.width = contextWidth - (rectTopLeftX + rectWidth);\n  rectRadius.right.height = rectHeight;\n\n  return rectRadius;\n};\n\n// Draw outside rectangles\nexport const clipRect = (ctx: any, coordinates: ICoordinate, color: any) => {\n  ctx.beginPath();\n  ctx.fillStyle = color;\n\n  // Top area\n  ctx.fillRect(coordinates.top.x, coordinates.top.y, coordinates.top.width, coordinates.top.height);\n\n  // Bottom side\n  ctx.fillRect(\n    coordinates.bottom.x,\n    coordinates.bottom.y,\n    coordinates.bottom.width,\n    coordinates.bottom.height\n  );\n\n  // Left area\n  ctx.fillRect(\n    coordinates.left.x,\n    coordinates.left.y,\n    coordinates.left.width,\n    coordinates.left.height\n  );\n\n  // Right area\n  ctx.fillRect(\n    coordinates.right.x,\n    coordinates.right.y,\n    coordinates.right.width,\n    coordinates.right.height\n  );\n\n  ctx.fill();\n  ctx.closePath();\n};\n\nexport const getColor = (imageData: any, x: number, y: number, width: number): string => {\n  const index = (x + y * width) * 4;\n  const r = imageData.data[index + 0];\n  const g = imageData.data[index + 1];\n  const b = imageData.data[index + 2];\n  const a = imageData.data[index + 3];\n  return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\n};\n\nexport const cropImage = (ctx: any, x: number, y: number, w: number, h: number, scale?: number) => {\n  // Original size\n  /*\n  let canvas = document.createElement('canvas');\n  canvas.width = w;\n  canvas.height = h;\n  let context = canvas.getContext('2d');\n  context.rect(0, 0, w, h);\n  context.fillStyle = 'white';\n  context.fill();\n  context.putImageData(ctx.getImageData(x, y, w, h), 0, 0);\n  return canvas.toDataURL(fileExtension);\n  */\n\n  // With scale\n  let i, j, it, jt;\n  scale = scale || 1;\n  let canvas = document.createElement('canvas');\n  canvas.width = w * scale;\n  canvas.height = h * scale;\n  let context = canvas.getContext('2d');\n  if (context) {\n    let sourceData = ctx.getImageData(x, y, w, h);\n    context.beginPath();\n    for (i = 0; i < w; i++) {\n      it = i * scale;\n      for (j = 0; j < h; j++) {\n        jt = j * scale;\n        let color = getColor(sourceData, i, j, w);\n        context.fillStyle = color;\n        context.fillRect(it, jt, scale, scale);\n      }\n    }\n  }\n  return canvas;\n};\n","declare var window: any;\n\n// return a promise that resolves with a File instance\n// Usage example:\n// base64toFile('data:text/plain;base64,aGVsbG8gd29ybGQ=', 'hello.txt', 'text/plain').then(function(file){console.log(file);});\nexport const base64toFile = (url: string, filename: string, mimeType: string) => {\n  return fetch(url)\n    .then(res => {\n      return res.arrayBuffer();\n    })\n    .then(buf => {\n      return new File([buf], filename, { type: mimeType });\n    });\n};\n\nexport const getBlobFromImageData = (image_data: string) => {\n  let blob: any;\n\n  const parsedImageData = atob(image_data.split(',')[1]);\n\n  // Use typed arrays to convert the binary data to a Blob\n  let arraybuffer = new ArrayBuffer(parsedImageData.length);\n  let view = new Uint8Array(arraybuffer);\n\n  for (let i = 0; i < parsedImageData.length; i++) {\n    view[i] = parsedImageData.charCodeAt(i) & 0xff;\n  }\n\n  try {\n    // This is the recommended method:\n    blob = new Blob([arraybuffer], {\n      type: 'application/octet-stream'\n    });\n  } catch (e) {\n    // The BlobBuilder API has been deprecated in favour of Blob, but older\n    // browsers don't know about the Blob constructor\n    // IE10 also supports BlobBuilder, but since the `Blob` constructor\n    //  also works, there's no need to add `MSBlobBuilder`.\n    let bb = new (window.WebKitBlobBuilder || window.MozBlobBuilder)();\n    bb.append(arraybuffer);\n    blob = bb.getBlob('application/octet-stream'); // <-- Here's the Blob\n  }\n\n  return blob;\n};\n","declare var window: any;\ndeclare var canvasResize: any;\ndeclare var saveAs: any;\n\nimport {\n  getRectCoordinates,\n  getOutsideRectCoordinates,\n  clipRect,\n  drawRect,\n  detectContour,\n  isValidPoint,\n  cropImage\n} from './cv';\nimport { IRatio, IVideoInput, IDetector } from './interfaces';\n\nimport { getBlobFromImageData, base64toFile } from './utils';\n\nexport default class Detector {\n  private ceil: number;\n  private width: number;\n  private height: number;\n  private lineWidth: number;\n  private dpi: number;\n\n  private rectBorderDefaultColor: string;\n  private rectBorderColorSuccess: string;\n  private rectBorderColorError: string;\n  private outsideBackgroundColor: string;\n\n  private drawContour = false;\n  private isImageCaptured = false;\n\n  private mimeType: string;\n  private imageExtension: string;\n\n  private originalCanvas: any;\n  private cropContainer: any;\n  private outsideRectCoordinates: any;\n  private imageData: any;\n  private strokeColor: string;\n\n  private currentStream: any;\n  private videoInputList: Array<IVideoInput>;\n  private raf: any;\n\n  private roundRectX: number;\n  private roundRectY: number;\n  private roundRectWidth: number;\n  private roundRectHeight: number;\n\n  private ratio: IRatio;\n  private formattedRatio: IRatio;\n\n  constructor(options: IDetector) {\n    this.ceil = options.ceil || 50;\n    this.width = options.width || 400;\n    this.height = options.height || 600;\n    this.lineWidth = options.lineWidth || 5;\n    this.dpi = options.dpi || 300;\n\n    this.rectBorderDefaultColor = options.rectBorderDefaultColor || 'white';\n    this.rectBorderColorSuccess = options.rectBorderColorSuccess || 'green';\n    this.rectBorderColorError = options.rectBorderColorError || 'red';\n    this.outsideBackgroundColor = options.outsideBackgroundColor || 'rgba(0, 0, 0, 0.3)';\n\n    this.drawContour = options.drawContour || false;\n    this.isImageCaptured = false;\n\n    this.mimeType = options.mimeType || 'image/png';\n    this.imageExtension = options.imageExtension || 'png';\n\n    this.originalCanvas = null;\n    this.cropContainer = null;\n    this.outsideRectCoordinates = null;\n    this.imageData = null;\n    this.strokeColor = this.rectBorderDefaultColor;\n\n    this.currentStream = undefined;\n    this.videoInputList = [];\n    this.raf = null;\n\n    this.roundRectX = this.ceil;\n    this.roundRectY = this.ceil;\n    this.roundRectWidth = this.width - this.ceil * 2;\n    this.roundRectHeight = this.height - this.ceil * 3;\n\n    this.ratio = options.ratio || { w: 210, h: 297 }; // A4 by default\n    this.formattedRatio = this.ratio;\n  }\n\n  initRectRatio(ratio: number, w: number, h: number, ceil: number) {\n    let obj: any = {};\n    let canvasRatio: number = w / h;\n    const assign = (mainProp: string, dependentProp: string, r: number, canvasProp: number) => {\n      if (w <= h) {\n        obj[mainProp] = canvasProp - ceil * 2;\n        obj[dependentProp] = obj[mainProp] * r;\n      } else {\n        obj[dependentProp] = canvasProp - ceil * 2;\n        obj[mainProp] = obj[dependentProp] * r;\n      }\n    };\n    if (w === h || canvasRatio > 1) {\n      assign('h', 'w', 1 / ratio, h);\n    } else if (canvasRatio < ratio) {\n      assign('h', 'w', ratio, h);\n    } else {\n      assign('w', 'h', 1 / ratio, w);\n    }\n    obj.x = (w - obj.w) / 2;\n    obj.y = (h - obj.h) / 2;\n    return obj;\n  }\n\n  // Init rectangle coordinates\n  initRectCoordinates() {\n    this.formattedRatio.w = this.ratio.w;\n    this.formattedRatio.h = this.ratio.h;\n    if (this.width >= this.height) {\n      this.formattedRatio.w = this.ratio.h;\n      this.formattedRatio.h = this.ratio.w;\n    }\n\n    let ratio: number = this.formattedRatio.w / this.formattedRatio.h;\n    let rectangle: any = this.initRectRatio(ratio, this.width, this.height, this.ceil);\n\n    this.roundRectX = rectangle.x;\n    this.roundRectY = rectangle.y;\n    this.roundRectWidth = rectangle.w;\n    this.roundRectHeight = rectangle.h;\n\n    // Get centered rectangle coordinates\n    this.cropContainer = getRectCoordinates(\n      this.roundRectX,\n      this.roundRectY,\n      this.roundRectWidth,\n      this.roundRectHeight\n    );\n\n    this.outsideRectCoordinates = getOutsideRectCoordinates(\n      this.ceil,\n      this.width,\n      this.cropContainer.tl.x,\n      this.cropContainer.tl.y,\n      this.cropContainer.tr.x,\n      this.cropContainer.tr.y,\n      this.cropContainer.bl.y,\n      this.roundRectWidth,\n      this.roundRectHeight\n    );\n  }\n\n  // Draw image data\n  putImageData(context: any, video: any) {\n    // Hack to center stream on mobile devices\n    let dx: number = 0;\n    let innerWidth: number = window.innerWidth;\n    if (innerWidth < 450) {\n      dx = video.width / 4;\n    }\n    // Draw video stream\n    context.drawImage(video, -dx, 0, video.width, video.height);\n\n    // Get image data\n    this.imageData = context.getImageData(0, 0, video.width, video.height);\n\n    // Clear rect\n    context.clearRect(0, 0, this.width, this.height);\n\n    // Render stream into canvas\n    context.putImageData(this.imageData, 0, 0);\n  }\n\n  drawRectangle(context: any) {\n    // Draw outside rectangle\n    if (this.outsideRectCoordinates) {\n      clipRect(context, this.outsideRectCoordinates, this.outsideBackgroundColor);\n    }\n\n    // Draw rectangle\n    drawRect(\n      context,\n      this.roundRectX,\n      this.roundRectY,\n      this.roundRectWidth,\n      this.roundRectHeight,\n      this.lineWidth,\n      this.strokeColor\n    );\n\n    // Update border color\n    if (!this.isImageCaptured) {\n      this.strokeColor = this.rectBorderDefaultColor;\n    }\n  }\n\n  // Detect object\n  detect(context: any, callback: Function) {\n    if (!this.imageData) {\n      callback();\n      return;\n    }\n\n    // Detect contours\n    var candidates: Array<any>[] = detectContour(this.imageData, this.ceil);\n\n    let self: any = this;\n    // Find object\n    self.findObject(context, candidates, 0, 0, () => {\n      let timeout: any = window.setTimeout(() => {\n        self.isImageCaptured = false;\n        window.clearTimeout(timeout);\n      }, 2000);\n      callback();\n    });\n  }\n\n  // Find object\n  findObject(context: any, contours: Array<any>[], x: number, y: number, callback: Function) {\n    let i: number = contours.length,\n      contour: any;\n    while (i--) {\n      if (!this.isImageCaptured) {\n        contour = contours[i];\n        this.strokeColor = this.rectBorderColorError;\n\n        if (contour && contour.length === 4 && this.cropContainer) {\n          contour.isValide = isValidPoint(contour.point, this.cropContainer, 5);\n\n          if (contour.point.width > 0 && contour.point.height > 0 && contour.isValide) {\n            this.strokeColor = this.rectBorderColorSuccess;\n\n            this.isImageCaptured = true;\n\n            // Object found : trigger callback\n            callback();\n          }\n\n          // Draw contour\n          if (this.drawContour) {\n            this.drawContours(context, contour, x, y);\n          }\n        }\n      }\n    }\n  }\n\n  // Draw contour\n  drawContours(context: any, contour: any, x: number, y: number) {\n    context.strokeStyle = contour.isValide ? 'blue' : 'red';\n    context.beginPath();\n    for (var j = 0; j < contour.length; ++j) {\n      var point = contour[j];\n      context.moveTo(x + point.x, y + point.y);\n      point = contour[(j + 1) % contour.length];\n      context.lineTo(x + point.x, y + point.y);\n    }\n    context.stroke();\n    context.closePath();\n  }\n\n  // Crop image\n  cropImage(context: any) {\n    this.originalCanvas = cropImage(\n      context,\n      this.roundRectX + this.lineWidth,\n      this.roundRectY + this.lineWidth,\n      this.roundRectWidth - this.lineWidth * 2,\n      this.roundRectHeight - this.lineWidth * 2\n    );\n\n    this.isImageCaptured = false;\n\n    return this.originalCanvas.toDataURL(this.mimeType);\n  }\n\n  // Resize canvas\n  resizeCanvas(callback: Function) {\n    if (!this.originalCanvas) {\n      callback(null);\n      return;\n    }\n\n    // Create canvas with dpi size (by default : 300)\n    let dpmm: number = this.dpi / 25.4; // Pixels per mm = 300 dpi / 25.4 = 11.811 dpmm\n    let pixelRatioWidth: number = Math.round(this.formattedRatio.w * dpmm); // by default (210 mm x 11.811 dpmm) : 2480 px\n    let pixelRatioHeight: number = Math.round(this.formattedRatio.h * dpmm); // by default (297 mm x 11.811 dpmm) : 3508 px\n\n    let resizedCanvas: any = document.createElement('canvas');\n    resizedCanvas.width = pixelRatioWidth;\n    resizedCanvas.height = pixelRatioHeight;\n\n    let self: any = this;\n    // Resize canvas\n    canvasResize(self.originalCanvas, resizedCanvas, () => {\n      // resized will now be a properly resized version of canvas\n      let resizedBase64Data: string = resizedCanvas.toDataURL(self.mimeType);\n      callback(resizedBase64Data);\n    });\n  }\n\n  // Download image\n  download(imageName: string, imageData: any) {\n    let blob: any = getBlobFromImageData(imageData);\n    let fileName: string = imageName + '.' + this.imageExtension;\n    saveAs(blob, fileName);\n  }\n\n  // Convert base64 to file\n  convertBase64toFile(imageName: string, base64Data: string, callback: any) {\n    let fileName: string = imageName + '.' + this.imageExtension;\n    base64toFile(base64Data, fileName, this.mimeType).then(callback);\n  }\n\n  // Get media track\n  stopMediaTracks(stream: any) {\n    stream.getTracks().forEach((track: any) => {\n      track.stop();\n    });\n  }\n\n  // Get camera devices\n  gotDevices(mediaDevices: Array<any>[]) {\n    let self: any = this;\n    let count: number = 1;\n    try {\n      self.videoInputList = [];\n      mediaDevices.forEach((mediaDevice: any) => {\n        if (mediaDevice.kind === 'videoinput') {\n          const element: IVideoInput = {\n            id: mediaDevice.deviceId,\n            label: mediaDevice.label || 'Camera' + count++\n          };\n          self.videoInputList.push(element);\n        }\n      });\n    } catch (ex) {}\n  }\n\n  // Get camera stream\n  getCamera(isDesktop: boolean, resolve: any, reject: any) {\n    if (this.currentStream) {\n      this.stopMediaTracks(this.currentStream);\n    }\n\n    var videoConstraints: any = {};\n    if (isDesktop && !!this.videoInputList.length) {\n      videoConstraints.deviceId = { exact: this.videoInputList[0].id };\n    } else {\n      videoConstraints.facingMode = 'environment';\n    }\n\n    let self: any = this;\n\n    window\n      .getUserMedia({\n        video: videoConstraints,\n        audio: false\n      })\n      .then((stream: any) => {\n        self.currentStream = stream;\n        resolve(stream);\n        return window.enumerateDevices();\n      })\n      .then(self.gotDevices)\n      .catch((err: any) => {\n        reject(err);\n      });\n\n    window.enumerateDevices().then(self.gotDevices);\n  }\n\n  // Request animation frame\n  requestAnimationFrame(tick: any) {\n    this.raf = window.requestAnimationFrame(tick);\n  }\n\n  // Cancel animation frame\n  cancelAnimationFrame() {\n    if (this.raf) {\n      window.cancelAnimationFrame(this.raf);\n    }\n  }\n}\n"],"names":["global"],"mappings":"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"}